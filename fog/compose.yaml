services:
  teraspot-fog:
    build: .
    image: teraspot-fog:dev
    container_name: teraspot-fog
    restart: unless-stopped
    environment:
      AWS_IOT_ENDPOINT: ${AWS_IOT_ENDPOINT}
      AWS_IOT_CERT_PATH: ${AWS_IOT_CERT_PATH}
      AWS_IOT_THING_NAME: ${AWS_IOT_THING_NAME}
      AWS_IOT_FACILITY_ID: ${AWS_IOT_FACILITY_ID}
      AWS_IOT_ZONE_ID: ${AWS_IOT_ZONE_ID}
      AWS_IOT_TOPIC: ${AWS_IOT_TOPIC}
      PYTHONUNBUFFERED: ${PYTHONUNBUFFERED}
    stdin_open: true
    tty: true
    command: >-
      python src/edge_publisher.py
      --use-yolo
      --video assets/parking_lot.mp4
      --frame-skip 5
      --iterations -1
      --interval 5
      --roi-config config/roi_sample.json
